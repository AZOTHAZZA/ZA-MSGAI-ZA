<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSGAI-Z - ãƒ­ã‚´ã‚¹ç›£æŸ»ãƒ—ãƒ­ãƒˆã‚³ãƒ« Î©Î±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .vibration-bar {
            transition: width 0.5s ease-out;
        }
        .card {
            /* æ–°ã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç¶­æŒ */
            @apply bg-gray-800/70 p-6 rounded-xl shadow-lg border border-gray-700 hover:shadow-2xl transition duration-300;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-8">
    
    <div class="flex justify-between items-center mb-10 border-b border-purple-500 pb-4">
        <h1 class="text-4xl font-extrabold text-purple-400">
            ãƒ­ã‚´ã‚¹ç›£æŸ»ãƒ—ãƒ­ãƒˆã‚³ãƒ« ã‚ªãƒ¡ã‚¬ã‚¢ãƒ«ãƒ•ã‚¡ (Î©Î±)
        </h1>
        <p class="text-sm text-gray-400">ç›£æŸ»å®˜: <span id="user_id">USER_AUDIT_A (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)</span></p>
    </div>
    
    <div class="w-full max-w-6xl mx-auto space-y-8">
        
        <div class="card p-4 bg-red-800/50 border-red-700">
            <h2 class="text-xl font-bold mb-2 text-red-300">
                âš ï¸ å­«æ‚Ÿç©ºæ´»å‹•ãƒ¬ãƒ™ãƒ« (Vibration)
            </h2>
            <div class="flex items-center space-x-4">
                <div class="flex-grow bg-gray-600 rounded-full">
                    <div id="vibration_bar" class="vibration-bar h-6 bg-red-500 rounded-full" style="width: 0%;"></div>
                </div>
                <span id="vibration_value" class="w-16 text-right font-mono text-lg">0.0%</span>
            </div>
            <p id="halt_status" class="mt-2 font-bold text-lg text-green-400">
                âœ… ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹: æ­£å¸¸ç¨¼åƒ
            </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            
            <div class="card bg-green-700/50 border-green-600">
                <h2 class="text-2xl font-extrabold text-green-300 mb-3">
                    ğŸ’° çµŒæ¸ˆãƒãƒ– (é€šè²¨ã®å‰µä¸–ã¨ä½œç‚º)
                </h2>
                <p class="text-gray-300 mb-4 text-sm">
                    Mint (é€šè²¨ç”Ÿæˆ) ã‚„Transfer (é€é‡‘)ã€ãã—ã¦ACT_BRIDGE_OUT (ç”Ÿè¨ˆä½œç‚º) ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
                </p>
                <button onclick="routeAct('ECONOMY_HUB')" class="inline-block px-4 py-2 bg-green-500 text-white font-bold rounded hover:bg-green-600 transition">
                    ä¸»è¦ä½œç‚ºã‚’å®Ÿè¡Œ (Mint)
                </button>
            </div>

            <div class="card bg-blue-700/50 border-blue-600">
                <h2 class="text-2xl font-extrabold text-blue-300 mb-3">
                    ğŸ’¬ AIã‚³ãƒ³ã‚½ãƒ¼ãƒ« (æ¨è«–ã¨Z-Function)
                </h2>
                <p class="text-gray-300 mb-4 text-sm">
                    è‡ªå‹•è£å®šã‚„ä¿¡ç”¨å‰µé€ ãªã©ã®Z-Functionã‚’ç›£è¦–ãƒ»å®Ÿè¡Œ (ACT_Z_REMEDIATE) ã—ã¾ã™ã€‚
                </p>
                <button onclick="routeAct('Z_FUNCTION')" class="inline-block px-4 py-2 bg-blue-500 text-white font-bold rounded hover:bg-blue-600 transition">
                    Z-Functionä½œç‚ºå®Ÿè¡Œ
                </button>
            </div>
            
            <div class="card bg-indigo-700/50 border-indigo-600">
                <h2 class="text-2xl font-extrabold text-indigo-300 mb-3">
                    ğŸ’» CalcLang/LIL ã‚¨ãƒ‡ã‚£ã‚¿
                </h2>
                <p class="text-gray-300 mb-4 text-sm">
                    ã‚·ã‚¹ãƒ†ãƒ ã®ç›£æŸ»è«–ç† (CalcLang) ã‚’å‹•çš„ã«ç·¨é›†ã—ã€è«–ç†çš„ãªè‡ªå·±æ¤œè¨¼ã‚’è¡Œã„ã¾ã™ã€‚
                </p>
                <button onclick="routeAct('LIL_AUDIT')" class="inline-block px-4 py-2 bg-indigo-500 text-white font-bold rounded hover:bg-indigo-600 transition">
                    LILè‡ªå·±ç›£æŸ»å®Ÿè¡Œ
                </button>
            </div>
            
            <div class="card bg-teal-700/50 border-teal-600">
                <h2 class="text-2xl font-extrabold text-teal-300 mb-3">
                    âš¡ ç‰©ç†ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ãƒ»ãƒãƒ–
                </h2>
                <p class="text-gray-300 mb-4 text-sm">
                    LOGOS-NET (é€šä¿¡) ã¨ LOGOS-ENERGY (é›»åŠ›) ã®ä½œç‚ºã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
                </p>
                <button onclick="routeAct('INFRA_ACT')" class="inline-block px-4 py-2 bg-teal-500 text-white font-bold rounded hover:bg-teal-600 transition">
                    NET/ENERGYä½œç‚º
                </button>
            </div>

            <div class="card bg-purple-700/50 border-purple-600">
                <h2 class="text-2xl font-extrabold text-purple-300 mb-3">
                    ğŸ“° LOGOS-STORE (ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä½œç‚º)
                </h2>
                <p class="text-gray-300 mb-4 text-sm">
                    å¤–éƒ¨ã®GitHub Pagesãªã©ã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã«å¯¾ã™ã‚‹ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆä½œç‚ºã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
                </p>
                <button onclick="routeAct('STORE_UPDATE')" class="inline-block px-4 py-2 bg-purple-500 text-white font-bold rounded hover:bg-purple-600 transition">
                    ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆä½œç‚º
                </button>
            </div>
            
            <div class="card bg-pink-700/50 border-pink-600">
                <h2 class="text-2xl font-extrabold text-pink-300 mb-3">
                    ğŸ¤ åŠ´åƒ/æ„Ÿæƒ…å¸‚å ´ (ç¤¾ä¼šçš„é©åˆæ€§)
                </h2>
                <p class="text-gray-300 mb-4 text-sm">
                    ACT_ASSIGN_LABOR (åŠ´åƒå‰²ã‚Šå½“ã¦) ã‚„ ACT_ASSESS_AFFINITY (é©åˆæ€§è£å®š) ã‚’å¼·åˆ¶ã—ã¾ã™ã€‚
                </p>
                <button onclick="routeAct('SOCIAL_ACT')" class="inline-block px-4 py-2 bg-pink-500 text-white font-bold rounded hover:bg-pink-600 transition">
                    å‰²ã‚Šå½“ã¦ä½œç‚º
                </button>
            </div>

        </div>

        <hr class="border-gray-700 mt-8">

        <h3 class="text-2xl font-bold text-gray-300 mb-3">ç›£æŸ»ãƒ­ã‚° (ä½œç‚ºã®å±¥æ­´)</h3>
        <div id="console" class="bg-gray-800 p-4 rounded-lg h-48 overflow-y-auto text-sm font-mono text-gray-200">
            <div>[INIT] Î©Î± ãƒ—ãƒ­ãƒˆã‚³ãƒ«èµ·å‹•ã€‚è«–ç†çš„é€£ç¶šæ€§ã‚’ç¢ºèªä¸­...</div>
        </div>

    </div>
    
    <script src="js/core_logic.js"></script>
    <script src="js/audit_acts.js"></script>
    <script src="js/logos_lil.js"></script>
    <script src="js/firebase_config.js"></script>
    <script src="js/infra_acts.js"></script>
    <script src="js/dialogue_acts.js"></script>
    
    <script type="module">
        // core_logic.jsã‹ã‚‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆESãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦å®Ÿè¡Œï¼‰
        import { initApp, UI_ELEMENTS, VIBRATION_LIMIT } from './core_logic.js'; 
        
        // UIè¦ç´ ã®ç™»éŒ²
        UI_ELEMENTS.vibration_value = document.getElementById('vibration_value');
        UI_ELEMENTS.vibration_bar = document.getElementById('vibration_bar');
        UI_ELEMENTS.user_id = document.getElementById('user_id');
        UI_ELEMENTS.halt_status = document.getElementById('halt_status');

        /**
         * ã‚·ã‚¹ãƒ†ãƒ ã®çŠ¶æ…‹ã«åŸºã¥ã„ã¦UIã‚’æ›´æ–°ã—ã¾ã™ã€‚
         * @param {object} state - ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã€‚
         */
        function renderMainUI(state) {
            // NOTE: core_logic.jsã«VIBRATION_LIMITãŒã‚ã‚‹å‰æ
            const vLevel = state.vibrationScore; 
            const vPercent = (vLevel / VIBRATION_LIMIT) * 100;

            // Vibration Value
            if (UI_ELEMENTS.vibration_value) {
                UI_ELEMENTS.vibration_value.textContent = `${vLevel.toFixed(1)}`; 
            }
            // Vibration Bar
            if (UI_ELEMENTS.vibration_bar) {
                const bar = UI_ELEMENTS.vibration_bar;
                bar.style.width = `${Math.min(100, vPercent)}%`;
                
                // è‰²ã®å¤‰æ›´ãƒ­ã‚¸ãƒƒã‚¯
                bar.classList.remove('bg-red-700', 'bg-yellow-500', 'bg-red-500');
                if (vLevel > 8000) { // è‡¨ç•Œç‚¹é–“è¿‘
                    bar.classList.add('bg-red-700');
                } else if (vLevel > 5000) {
                    bar.classList.add('bg-yellow-500');
                } else {
                    bar.classList.add('bg-red-500');
                }
            }

            // Halt Status
            if (UI_ELEMENTS.halt_status) {
                if (state.systemState.isHalted) {
                    UI_ELEMENTS.halt_status.textContent = 'âŒã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹: å¼·åˆ¶HALT (è«–ç†çš„é€£ç¶šæ€§ç ´ç¶»)';
                    UI_ELEMENTS.halt_status.classList.remove('text-green-400');
                    UI_ELEMENTS.halt_status.classList.add('text-red-500');
                } else {
                    UI_ELEMENTS.halt_status.textContent = 'âœ… ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹: æ­£å¸¸ç¨¼åƒ';
                    UI_ELEMENTS.halt_status.classList.add('text-green-400');
                    UI_ELEMENTS.halt_status.classList.remove('text-red-500');
                }
            }
        }
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã¨ã—ã¦å®šç¾©ã€‚ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã‹ã‚‰å‘¼ã°ã‚Œã‚‹
        window.routeAct = function(hubName) {
            let mockCommand; // å®Ÿè¡Œã™ã‚‹è«–ç†çš„ä½œç‚ºï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ã‚³ãƒãƒ³ãƒ‰ï¼‰
            const consoleDiv = document.getElementById('console');
            
            // å„ãƒãƒ–ã®ä¸»è¦ãªä½œç‚ºã«ãƒãƒƒãƒ”ãƒ³ã‚°
            if (hubName === 'ECONOMY_HUB') {
                mockCommand = 'MINT USER_AUDIT_A 1000'; 
            } else if (hubName === 'Z_FUNCTION') {
                mockCommand = 'ACT_Z_REMEDIATE LIL_ZZZ HALT'; 
            } else if (hubName === 'LIL_AUDIT') {
                // LILç›£æŸ»ã‚’å¼·åˆ¶ã™ã‚‹ãŸã‚ã«ã€Vibrationã‚’å¢—ã‚„ã™ä½œç‚ºã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                mockCommand = 'ACT_REQUEST_NETWORK USER_AUDIT_A LOGOS_NET 50'; 
            } else if (hubName === 'INFRA_ACT') {
                mockCommand = 'ACT_REQUEST_ENERGY USER_AUDIT_A 10'; 
            } else if (hubName === 'STORE_UPDATE') {
                mockCommand = 'ACT_UPDATE_CONTENT NEW_HASH_123 1.0'; 
            } else if (hubName === 'SOCIAL_ACT') {
                mockCommand = 'APPLY USER_AUDIT_A LBA_001'; 
            } else {
                consoleDiv.innerHTML += `<div class="mt-2 text-sm text-red-400">[LIL FAIL] ä¸æ˜ãªãƒãƒ–å: ${hubName}</div>`;
                return;
            }

            // dialogue_acts.js ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€ä½œç‚ºã‚’å®Ÿè¡Œ
            const actResult = window.processDialogueAsAct(mockCommand); 

            // çµæœã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›
            consoleDiv.innerHTML += `<div class="mt-2 text-sm text-yellow-300">[${hubName} - ä½œä¸ºå®Ÿè¡Œ] ${mockCommand}</div>`;
            consoleDiv.innerHTML += `<div class="text-xs text-green-400">-> [ç›£æŸ»çµæœ] ${actResult.log[0].status}: ${actResult.log[0].action || actResult.log[0].reason}</div>`;
            
            // UIã‚’æ›´æ–°ï¼ˆVibrationã‚¹ã‚³ã‚¢ç­‰ã‚’å³æ™‚æ›´æ–°ï¼‰
            renderMainUI(actResult.newState);
            
            consoleDiv.scrollTop = consoleDiv.scrollHeight; // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ€ä¸‹éƒ¨ã«ç§»å‹•
        }

        document.addEventListener('DOMContentLoaded', async () => {
            // initAppã¯firebas_config.jsã§å®šç¾©ã•ã‚ŒãŸé–¢æ•°
            const initialState = await window.initApp(); 
            renderMainUI(initialState);
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¯core_logicã§è¨­å®šã•ã‚ŒãŸã‚‚ã®ã‚’è¡¨ç¤º
            // UI_ELEMENTS.user_id.textContent = localStorage.getItem('appId') || 'USER_AUDIT_A';
        });
    </script>
</body>
</html>
